import{c as g}from"./supabase-vendor-CklQTOeK.js";const i=window.location.origin;async function f(r){try{let e=r;if(!e)return null;const{data:{session:t}}=await e.auth.getSession();return(t==null?void 0:t.access_token)||null}catch{return null}}async function c(r,e={},t){try{const n=await f(t);if(!n)return{error:"Not authenticated. Please sign in to use AI features."};const s=`${i}${r}`,o=await fetch(s,{...e,headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`,...e.headers}});let a;const u=o.headers.get("content-type");if(u&&u.includes("application/json"))a=await o.json();else return{error:`Server returned non-JSON response: ${(await o.text()).substring(0,200)}`};return o.ok?{data:a}:{error:typeof a.error=="object"?a.error.message||JSON.stringify(a.error):a.error||`Request failed with status ${o.status}`,message:a.message}}catch(n){return n instanceof TypeError&&n.message.includes("fetch")?{error:`Failed to connect to API server. Please check:
- Is the server running? (Expected: ${i})
- Is VITE_API_URL set correctly in your .env file?
- Check your network connection and CORS settings.`}:{error:n instanceof Error?n.message:"Network error occurred"}}}async function l(r,e){return c("/api/ai/generate-flashcards",{method:"POST",body:JSON.stringify(r)},e)}async function p(r,e){return c("/api/ai/generate-knowledge-organizer",{method:"POST",body:JSON.stringify(r)},e)}const y=async(r,e)=>c("/api/ai/chat",{method:"POST",body:JSON.stringify(r)},e);async function w(r,e){try{const{data:{session:t}}=await r.auth.getSession();if(!t)throw new Error("Not authenticated");let n=`${i}/api/ai/usage`;const s=await fetch(n,{method:"GET",headers:{Authorization:`Bearer ${t.access_token}`,"Content-Type":"application/json"}});if(!s.ok){const a=await s.json();throw new Error(a.error||"Failed to fetch usage stats")}return{data:await s.json()}}catch(t){return{error:t.message}}}export{l as a,p as b,y as c,w as g};

import{j as e,aQ as _,aT as q,ai as W,am as J,L as P,K,ao as G,X as U}from"./ui-vendor-CsSFJReh.js";import{A as Q}from"./AppLayout-DI_SoCqt.js";import{u as X,k as Y,B as f}from"./index-D0R12c3l.js";import{C as $}from"./card-D_wUZn1S.js";import{I as H}from"./input-BOrw0D0Z.js";import{r as l}from"./react-vendor-BmZbDsmQ.js";import"./AnimatedLogoIcon-D5-EYdni.js";import"./sheet-0_ECFM1J.js";import"./supabase-vendor-BcRMW6g-.js";import"./query-vendor-DjEy6XLK.js";function le(){const{user:r,supabase:c}=X(),{toast:d}=Y(),[u,x]=l.useState(25*60),[h,g]=l.useState(!1),[o,N]=l.useState("focus"),[A,I]=l.useState(0),[i,n]=l.useState([]),[j,b]=l.useState(""),[L,v]=l.useState(!0),[y,T]=l.useState(!1);l.useEffect(()=>{r?B():v(!1)},[r]);const B=async()=>{if(!(!c||!r))try{v(!0);const{data:s,error:t}=await c.from("focus_tasks").select("*").eq("user_id",r.id).order("created_at",{ascending:!1});if(t){if(t.code==="42P01"){const a=localStorage.getItem(`focus_tasks_${r.id}`);a&&n(JSON.parse(a))}}else n(s||[])}catch{const t=localStorage.getItem(`focus_tasks_${r==null?void 0:r.id}`);t&&n(JSON.parse(t))}finally{v(!1)}},p=s=>{r&&localStorage.setItem(`focus_tasks_${r.id}`,JSON.stringify(s))},C=async()=>{if(!j.trim())return;const s={id:crypto.randomUUID(),text:j.trim(),completed:!1,created_at:new Date().toISOString()};T(!0);try{if(c&&r){const{error:a}=await c.from("focus_tasks").insert({id:s.id,user_id:r.id,text:s.text,completed:!1,created_at:s.created_at});if(a&&a.code!=="42P01")throw a}const t=[s,...i];n(t),p(t),b(""),d({title:"Task Added",description:"Your task has been added to the list."})}catch{const a=[s,...i];n(a),p(a),b("")}finally{T(!1)}},F=async s=>{const t=i.find(m=>m.id===s);if(!t)return;const a=i.map(m=>m.id===s?{...m,completed:!m.completed}:m);n(a),p(a);try{c&&r&&await c.from("focus_tasks").update({completed:!t.completed}).eq("id",s)}catch{}t.completed||d({title:"Task Completed! ðŸŽ‰",description:"Great job! Keep up the momentum."})},M=async s=>{const t=i.filter(a=>a.id!==s);n(t),p(t);try{c&&r&&await c.from("focus_tasks").delete().eq("id",s)}catch{}d({title:"Task Removed",description:"Task has been deleted."})},R=async()=>{const s=i.filter(a=>a.completed).map(a=>a.id),t=i.filter(a=>!a.completed);n(t),p(t);try{c&&r&&s.length>0&&await c.from("focus_tasks").delete().in("id",s)}catch{}d({title:"Cleared",description:`${s.length} completed task(s) removed.`})};l.useEffect(()=>{let s;return h&&u>0?s=setInterval(()=>{x(t=>t-1)},1e3):u===0&&(g(!1),"Notification"in window&&Notification.permission==="granted"&&new Notification(o==="focus"?"Focus session complete!":"Break is over!"),o==="focus"?(I(t=>t+1),d({title:"Focus Session Complete! ðŸŽ¯",description:"Great work! Take a short break."}),N("break"),x(5*60)):(d({title:"Break Over!",description:"Ready to focus again?"}),N("focus"),x(25*60))),()=>clearInterval(s)},[h,u,o,d]);const z=()=>g(!h),D=()=>{g(!1),x(o==="focus"?25*60:5*60)},S=s=>{g(!1),N(s),x(s==="focus"?25*60:5*60)},E=s=>{const t=Math.floor(s/60),a=s%60;return`${t.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`},O=o==="focus"?(25*60-u)/(25*60)*100:(5*60-u)/(5*60)*100,w=i.filter(s=>s.completed).length,k=i.length;return e.jsx(Q,{children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-8 animate-fade-in pb-12",children:[e.jsxs("div",{className:"text-center space-y-2 mb-8",children:[e.jsxs("h1",{className:"text-3xl font-bold flex items-center justify-center gap-2",children:[e.jsx(_,{className:"w-8 h-8 text-red-500"}),"Focus Mode"]}),e.jsx("p",{className:"text-muted-foreground",children:"Block out distractions and master your time with the Pomodoro Technique."})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 items-start",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("div",{className:"flex gap-2 mb-6",children:[e.jsx(f,{variant:o==="focus"?"default":"outline",onClick:()=>S("focus"),className:o==="focus"?"bg-red-500 hover:bg-red-600":"",children:"Focus (25m)"}),e.jsx(f,{variant:o==="break"?"default":"outline",onClick:()=>S("break"),className:o==="break"?"bg-green-500 hover:bg-green-600":"",children:"Break (5m)"})]}),e.jsxs("div",{className:"relative w-72 h-72 rounded-full flex items-center justify-center",children:[e.jsxs("svg",{className:"absolute inset-0 w-full h-full -rotate-90",children:[e.jsx("circle",{cx:"144",cy:"144",r:"135",stroke:"currentColor",strokeWidth:"12",fill:"none",className:"text-muted/30"}),e.jsx("circle",{cx:"144",cy:"144",r:"135",stroke:"currentColor",strokeWidth:"12",fill:"none",strokeLinecap:"round",strokeDasharray:2*Math.PI*135,strokeDashoffset:2*Math.PI*135*(1-O/100),className:`transition-all duration-300 ${o==="focus"?"text-red-500":"text-green-500"}`})]}),e.jsxs("div",{className:"text-center z-10",children:[e.jsx("div",{className:"text-6xl font-mono font-bold tracking-tighter mb-2",children:E(u)}),e.jsx("div",{className:"uppercase tracking-widest text-sm font-semibold text-muted-foreground",children:h?o==="focus"?"Focusing...":"Resting...":"Paused"})]})]}),e.jsxs("div",{className:"flex gap-4 mt-6",children:[e.jsx(f,{size:"lg",className:`rounded-full w-16 h-16 p-0 ${o==="focus"?"bg-red-500 hover:bg-red-600":"bg-green-500 hover:bg-green-600"}`,onClick:z,children:h?e.jsx(q,{className:"w-6 h-6"}):e.jsx(W,{className:"w-6 h-6 ml-1"})}),e.jsx(f,{size:"lg",variant:"outline",className:"rounded-full w-16 h-16 p-0",onClick:D,children:e.jsx(J,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"mt-6 text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Sessions Completed Today"}),e.jsx("p",{className:"text-2xl font-bold text-primary",children:A})]})]}),e.jsxs($,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Session Tasks"}),w>0&&e.jsx(f,{variant:"ghost",size:"sm",onClick:R,className:"text-xs text-muted-foreground hover:text-destructive",children:"Clear Completed"})]}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx(H,{placeholder:"Add a task for this session...",value:j,onChange:s=>b(s.target.value),onKeyDown:s=>s.key==="Enter"&&C(),disabled:y}),e.jsx(f,{onClick:C,disabled:!j.trim()||y,size:"icon",children:y?e.jsx(P,{className:"w-4 h-4 animate-spin"}):e.jsx(K,{className:"w-4 h-4"})})]}),k>0&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between text-sm text-muted-foreground mb-1",children:[e.jsx("span",{children:"Progress"}),e.jsxs("span",{children:[w,"/",k," completed"]})]}),e.jsx("div",{className:"h-2 bg-muted rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-green-500 transition-all duration-300",style:{width:`${k>0?w/k*100:0}%`}})})]}),e.jsx("div",{className:"space-y-2 max-h-[350px] overflow-y-auto",children:L?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(P,{className:"w-6 h-6 animate-spin text-muted-foreground"})}):i.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx("p",{children:"No tasks yet."}),e.jsx("p",{className:"text-sm",children:"Add tasks to track your focus session goals!"})]}):i.map(s=>e.jsxs("div",{className:`group flex items-center gap-3 p-3 rounded-lg transition-all ${s.completed?"bg-green-500/10 border border-green-500/20":"bg-secondary/50 border border-border hover:border-primary/30"}`,children:[e.jsx("button",{onClick:()=>F(s.id),className:"flex-shrink-0",children:s.completed?e.jsx(G,{className:"w-5 h-5 text-green-500"}):e.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-primary/30 hover:border-primary transition-colors"})}),e.jsx("span",{className:`flex-1 ${s.completed?"line-through text-muted-foreground":""}`,children:s.text}),e.jsx("button",{onClick:()=>M(s.id),className:"opacity-0 group-hover:opacity-100 transition-opacity text-muted-foreground hover:text-destructive",children:e.jsx(U,{className:"w-4 h-4"})})]},s.id))})]})]}),e.jsxs($,{className:"p-6 bg-gradient-to-r from-red-500/5 to-orange-500/5 border-red-500/20",children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx(_,{className:"w-5 h-5 text-red-500"}),"Pomodoro Tips"]}),e.jsxs("ul",{className:"text-sm text-muted-foreground space-y-2",children:[e.jsx("li",{children:"â€¢ Work for 25 minutes, then take a 5-minute break"}),e.jsx("li",{children:"â€¢ After 4 sessions, take a longer 15-30 minute break"}),e.jsx("li",{children:"â€¢ Remove distractions: close unnecessary tabs and apps"}),e.jsx("li",{children:"â€¢ Write down tasks before starting to stay focused"})]})]})]})})}export{le as default};

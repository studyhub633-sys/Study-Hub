import{j as e,Q as C,L as R,aH as k,aI as S}from"./ui-vendor-C99L-hD9.js";import{A as E,a as n,b as i,c as d}from"./AppLayout-BFdv2Mth.js";import{B as T}from"./badge-C_rvkMXd.js";import{C as F,a as B,b as H,d as I}from"./card-CZtYvRKS.js";import{u as M,b as P}from"./index-Bze4zWta.js";import{r as m}from"./react-vendor-CW_qxVlV.js";import"./button-CTbG2CuD.js";import"./sheet-HbvxctKK.js";import"./supabase-vendor-BFJX04bJ.js";import"./query-vendor-CVP6rs-5.js";function z(){var x,h,f,j,p,b,u,v,g;const{supabase:y,user:r}=M(),{toast:w}=P(),[U,o]=m.useState(!0),[s,c]=m.useState([]);m.useEffect(()=>{_()},[r]);const _=async()=>{var a;try{o(!0);const{data:l,error:N}=await y.rpc("get_leaderboard",{limit_count:50});if(N)throw N;if(l&&l.length>0){const A=l.map(t=>({rank:t.rank,name:t.name,xp:t.xp,streak:t.streak,avatar:t.avatar_url,user_id:t.user_id,isUser:t.user_id===(r==null?void 0:r.id)}));c(A);return}c([])}catch{c([{rank:1,name:"Sarah J.",xp:12450,streak:45,avatar:null,user_id:"1",isUser:!1},{rank:2,name:"Mike T.",xp:11200,streak:32,avatar:null,user_id:"2",isUser:!1},{rank:3,name:"Alex R.",xp:10890,streak:28,avatar:null,user_id:"3",isUser:!1},{rank:4,name:((a=r==null?void 0:r.email)==null?void 0:a.split("@")[0])||"You",xp:8450,streak:12,avatar:null,user_id:(r==null?void 0:r.id)||"4",isUser:!0},{rank:5,name:"Emily W.",xp:8120,streak:15,avatar:null,user_id:"5",isUser:!1}]),w({title:"Notice",description:"Leaderboard running in demo mode. Run migration to see real data."})}finally{o(!1)}},L=a=>a.toLocaleString();return e.jsx(E,{children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6 animate-fade-in pb-12",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-3 rounded-xl bg-orange-500/10 text-orange-500",children:e.jsx(C,{className:"w-8 h-8"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Study Leaderboard"}),e.jsx("p",{className:"text-muted-foreground",children:"Review your weekly rankings and compete with peers."})]})]}),U?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(R,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):e.jsxs(e.Fragment,{children:[s.length>=3&&e.jsxs("div",{className:"grid grid-cols-3 gap-4 h-48 items-end mb-12 px-4",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs(n,{className:"w-16 h-16 border-4 border-slate-300 mb-2",children:[e.jsx(i,{src:((x=s[1])==null?void 0:x.avatar)||void 0}),e.jsx(d,{children:((h=s[1])==null?void 0:h.name[0])||"2"})]}),e.jsx("div",{className:"w-full h-24 bg-slate-200 dark:bg-slate-800 rounded-t-xl flex items-center justify-center text-2xl font-bold text-slate-400",children:"2"}),e.jsx("span",{className:"font-semibold text-sm mt-2",children:((f=s[1])==null?void 0:f.name)||"User"})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(k,{className:"w-8 h-8 text-orange-500 absolute -mt-12 animate-bounce"}),e.jsxs(n,{className:"w-20 h-20 border-4 border-yellow-400 mb-2 ring-4 ring-yellow-400/20",children:[e.jsx(i,{src:((j=s[0])==null?void 0:j.avatar)||void 0}),e.jsx(d,{children:((p=s[0])==null?void 0:p.name[0])||"1"})]}),e.jsx("div",{className:"w-full h-32 bg-yellow-400/20 border border-yellow-400 rounded-t-xl flex items-center justify-center text-4xl font-bold text-yellow-600",children:"1"}),e.jsx("span",{className:"font-semibold text-sm mt-2",children:((b=s[0])==null?void 0:b.name)||"User"})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs(n,{className:"w-16 h-16 border-4 border-amber-600 mb-2",children:[e.jsx(i,{src:((u=s[2])==null?void 0:u.avatar)||void 0}),e.jsx(d,{children:((v=s[2])==null?void 0:v.name[0])||"3"})]}),e.jsx("div",{className:"w-full h-20 bg-amber-700/20 rounded-t-xl flex items-center justify-center text-2xl font-bold text-amber-700",children:"3"}),e.jsx("span",{className:"font-semibold text-sm mt-2",children:((g=s[2])==null?void 0:g.name)||"User"})]})]}),e.jsxs(F,{children:[e.jsx(B,{children:e.jsx(H,{children:"Global Rankings"})}),e.jsx(I,{className:"p-0",children:e.jsx("div",{className:"divide-y",children:s.map(a=>e.jsxs("div",{className:`flex items-center p-4 gap-4 ${a.isUser?"bg-primary/5":"hover:bg-muted/50"}`,children:[e.jsx("div",{className:"w-8 text-center font-bold text-muted-foreground",children:a.rank<=3?e.jsx(S,{className:`w-5 h-5 mx-auto ${a.rank===1?"text-yellow-500":a.rank===2?"text-slate-400":"text-amber-600"}`}):a.rank}),e.jsxs(n,{children:[e.jsx(i,{src:a.avatar||void 0}),e.jsx(d,{children:a.name[0]})]}),e.jsx("div",{className:"flex-1",children:e.jsxs("h4",{className:"font-semibold flex items-center gap-2",children:[a.name,a.isUser&&e.jsx(T,{variant:"secondary",className:"text-[10px]",children:"YOU"})]})}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"font-bold",children:[L(a.xp)," XP"]}),e.jsxs("div",{className:"text-xs text-muted-foreground flex items-center justify-end gap-1",children:[e.jsx(k,{className:"w-3 h-3 text-orange-500"})," ",a.streak," day streak"]})]})]},a.user_id))})})]})]})]})})}export{z as default};

import{j as s,ao as A,Y as D,F,L as q}from"./ui-vendor-CsSFJReh.js";import{A as I}from"./AnimatedLogoIcon-D5-EYdni.js";import{A as f,a as w}from"./alert-5hDemh64.js";import{u as R,j as T,B as d}from"./index-D0R12c3l.js";import{C as z,a as B,b as M,c as H,d as O}from"./card-D_wUZn1S.js";import{I as j}from"./input-BOrw0D0Z.js";import{L as g}from"./label-CYC1LVAb.js";import{r as a,u as U,L as N}from"./react-vendor-BmZbDsmQ.js";import"./supabase-vendor-BcRMW6g-.js";import"./query-vendor-DjEy6XLK.js";function $(){const[r,v]=a.useState(""),[u,b]=a.useState(""),[o,y]=a.useState(!1),[m,i]=a.useState(""),[n,h]=a.useState(!1),[l,P]=a.useState(!1),{updatePassword:C,session:c,loading:x}=R(),S=U(),{t:e}=T(),[p,L]=a.useState(!0);a.useEffect(()=>{x||L(!1)},[x]);const k=async t=>{if(t.preventDefault(),i(""),r!==u){i(e("auth.passwordsDoNotMatch"));return}if(r.length<6){i(e("auth.passwordLength"));return}h(!0);try{await C(r),P(!0),setTimeout(()=>{S("/login")},3e3)}catch(E){i(E.message||"Failed to update password. Please try again.")}finally{h(!1)}};return s.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-b from-background to-muted/20 p-4",children:s.jsxs(z,{className:"w-full max-w-md",children:[s.jsxs(B,{className:"space-y-1 text-center",children:[s.jsx("div",{className:"flex justify-center mb-4",children:s.jsx(I,{})}),s.jsx(M,{className:"text-2xl font-bold",children:e("auth.setNewPassword")}),s.jsx(H,{children:e(l?"auth.successReset":!c&&!p?"auth.linkExpired":"auth.enterNewPassword")})]}),s.jsxs(O,{children:[!c&&!p&&!l&&s.jsxs("div",{className:"mb-4",children:[s.jsx(f,{variant:"destructive",children:s.jsx(w,{children:e("auth.sessionMissing")})}),s.jsx(N,{to:"/forgot-password",children:s.jsx(d,{variant:"outline",className:"w-full mt-2",children:e("auth.requestNewLink")})})]}),l?s.jsxs("div",{className:"text-center py-4 space-y-4",children:[s.jsx("div",{className:"flex justify-center",children:s.jsx(A,{className:"h-12 w-12 text-green-500 animate-in zoom-in duration-300"})}),s.jsx("p",{className:"text-muted-foreground",children:e("auth.passwordUpdated")}),s.jsx(N,{to:"/login",className:"block mt-4",children:s.jsx(d,{className:"w-full",children:e("auth.loginNow")})})]}):s.jsxs("form",{onSubmit:k,className:"space-y-4",children:[m&&s.jsx(f,{variant:"destructive",children:s.jsx(w,{children:m})}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(g,{htmlFor:"password",children:e("auth.newPassword")}),s.jsxs("div",{className:"relative",children:[s.jsx(j,{id:"password",type:o?"text":"password",placeholder:e("auth.enterNewPasswordPlaceholder"),value:r,onChange:t=>v(t.target.value),required:!0,disabled:n,className:"pr-10"}),s.jsx(d,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>y(!o),children:o?s.jsx(D,{className:"h-4 w-4 text-muted-foreground"}):s.jsx(F,{className:"h-4 w-4 text-muted-foreground"})})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(g,{htmlFor:"confirmPassword",children:e("common.confirmPassword")}),s.jsx(j,{id:"confirmPassword",type:o?"text":"password",placeholder:e("auth.confirmNewPasswordPlaceholder"),value:u,onChange:t=>b(t.target.value),required:!0,disabled:n})]}),s.jsx(d,{type:"submit",className:"w-full",disabled:n||!c,children:n?s.jsxs(s.Fragment,{children:[s.jsx(q,{className:"mr-2 h-4 w-4 animate-spin"}),e("auth.updatingDotted")]}):e("auth.updatePassword")})]})]})]})})}export{$ as default};

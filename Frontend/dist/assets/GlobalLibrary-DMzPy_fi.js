import{d as Ne,j as e,b as we,a6 as Se,P as I,f as E,e as Ce,a7 as Te,a8 as q,p as _e,G as Ae,$ as Pe,a9 as ke,v as Y,J as Le,z as K,s as Ie,aa as Re,K as Q}from"./ui-vendor-DGv3KiO9.js";import{A as Ee}from"./AppLayout-sFUUKKCT.js";import{B as o}from"./badge-C2VWINFk.js";import{B as w}from"./button-DKINiv1g.js";import{C as S,a as C,b as T,d as _,c as A}from"./card-Cht8Cdj-.js";import{I as U}from"./input-C_jrEiMJ.js";import{S as H,a as W,b as J,c as X,d as P}from"./select-D-R_R5Pr.js";import{r as n}from"./react-vendor-CW_qxVlV.js";import{c as Z,R as ze,I as Fe}from"./index-CIorOPrl.js";import{u as Me}from"./index-BV-fk3R2.js";import{c as z,u as Ge,b as $e}from"./index-D0d5eCQC.js";import{S as Be}from"./paper-parser-BorTS_p9.js";import"./sheet-BtLaM5v0.js";import"./index-BdQq_4o_.js";import"./supabase-vendor-CkhQzPV-.js";import"./query-vendor-BaxnY8JC.js";var R="Tabs",[Oe]=we(R,[Z]),ee=Z(),[Ve,F]=Oe(R),se=n.forwardRef((a,t)=>{const{__scopeTabs:l,value:d,onValueChange:u,defaultValue:p,orientation:i="horizontal",dir:f,activationMode:g="automatic",...v}=a,c=Me(f),[x,j]=Ne({prop:d,onChange:u,defaultProp:p??"",caller:R});return e.jsx(Ve,{scope:l,baseId:Se(),value:x,onValueChange:j,orientation:i,dir:c,activationMode:g,children:e.jsx(I.div,{dir:c,"data-orientation":i,...v,ref:t})})});se.displayName=R;var ae="TabsList",te=n.forwardRef((a,t)=>{const{__scopeTabs:l,loop:d=!0,...u}=a,p=F(ae,l),i=ee(l);return e.jsx(ze,{asChild:!0,...i,orientation:p.orientation,dir:p.dir,loop:d,children:e.jsx(I.div,{role:"tablist","aria-orientation":p.orientation,...u,ref:t})})});te.displayName=ae;var re="TabsTrigger",ie=n.forwardRef((a,t)=>{const{__scopeTabs:l,value:d,disabled:u=!1,...p}=a,i=F(re,l),f=ee(l),g=oe(i.baseId,d),v=ce(i.baseId,d),c=d===i.value;return e.jsx(Fe,{asChild:!0,...f,focusable:!u,active:c,children:e.jsx(I.button,{type:"button",role:"tab","aria-selected":c,"aria-controls":v,"data-state":c?"active":"inactive","data-disabled":u?"":void 0,disabled:u,id:g,...p,ref:t,onMouseDown:E(a.onMouseDown,x=>{!u&&x.button===0&&x.ctrlKey===!1?i.onValueChange(d):x.preventDefault()}),onKeyDown:E(a.onKeyDown,x=>{[" ","Enter"].includes(x.key)&&i.onValueChange(d)}),onFocus:E(a.onFocus,()=>{const x=i.activationMode!=="manual";!c&&!u&&x&&i.onValueChange(d)})})})});ie.displayName=re;var le="TabsContent",ne=n.forwardRef((a,t)=>{const{__scopeTabs:l,value:d,forceMount:u,children:p,...i}=a,f=F(le,l),g=oe(f.baseId,d),v=ce(f.baseId,d),c=d===f.value,x=n.useRef(c);return n.useEffect(()=>{const j=requestAnimationFrame(()=>x.current=!1);return()=>cancelAnimationFrame(j)},[]),e.jsx(Ce,{present:u||c,children:({present:j})=>e.jsx(I.div,{"data-state":c?"active":"inactive","data-orientation":f.orientation,role:"tabpanel","aria-labelledby":g,hidden:!j,id:v,tabIndex:0,...i,ref:t,style:{...a.style,animationDuration:x.current?"0s":void 0},children:j&&p})})});ne.displayName=le;function oe(a,t){return`${a}-trigger-${t}`}function ce(a,t){return`${a}-content-${t}`}var De=se,de=te,ue=ie,me=ne;const qe=De,xe=n.forwardRef(({className:a,...t},l)=>e.jsx(de,{ref:l,className:z("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...t}));xe.displayName=de.displayName;const k=n.forwardRef(({className:a,...t},l)=>e.jsx(ue,{ref:l,className:z("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",a),...t}));k.displayName=ue.displayName;const L=n.forwardRef(({className:a,...t},l)=>e.jsx(me,{ref:l,className:z("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...t}));L.displayName=me.displayName;function ns(){const{supabase:a,user:t}=Ge(),[l,d]=n.useState([]),[u,p]=n.useState([]),[i,f]=n.useState(""),[g,v]=n.useState("all"),[c,x]=n.useState("all"),[j,pe]=n.useState("papers"),[y,M]=n.useState(""),[G,$]=n.useState(!1),{toast:h}=$e(),he=n.useMemo(()=>[...new Set(l.map(r=>r.year))].filter(Boolean).sort((r,m)=>m-r),[l]),be=n.useMemo(()=>{const s=l.map(b=>b.subject),r=u.map(b=>b.subject);return[...new Set([...s,...r])].filter(Boolean).sort()},[l,u]);n.useEffect(()=>{fe(),ge()},[]);const fe=async()=>{const{data:s,error:r}=await a.from("global_past_papers").select("*").order("created_at",{ascending:!1});r?h({title:"Error",description:"Failed to fetch global papers.",variant:"destructive"}):d(s||[])},ge=async()=>{const{data:s,error:r}=await a.from("global_knowledge_organizers").select("*").order("created_at",{ascending:!1});r||p(s||[])},je=async()=>{if(y.trim()){$(!0);try{const s=Be.parse(y),{error:r}=await a.from("past_papers").insert({user_id:t==null?void 0:t.id,title:`${s.board} ${s.subjectCode||""} ${s.type} ${s.year||""} ${s.month||""}`,subject:s.subjectCode||"AQA General",year:s.year?parseInt(s.year):null,exam_board:s.board,file_url:y,file_type:"link"});if(r)throw r;h({title:"Smart Add Successful",description:"The paper has been added to your collection using AI parsing."}),M("")}catch{h({title:"Parsing Error",description:"We couldn't parse that link. Try adding it manually or check the URL.",variant:"destructive"})}finally{$(!1)}}},ve=async s=>{if(!t){h({title:"Login Required",description:"You must be logged in to add papers.",variant:"destructive"});return}try{const{data:r}=await a.from("past_papers").select("id").eq("user_id",t.id).eq("file_url",s.file_url).maybeSingle();if(r){h({title:"Already Added",description:"This paper is already in your collection."});return}const{error:m}=await a.from("past_papers").insert({user_id:t.id,title:s.title,subject:s.subject,year:s.year,exam_board:s.exam_board,file_url:s.file_url,file_type:s.file_type});if(m)throw m;h({title:"Added to Library",description:`${s.title} has been added to your papers.`})}catch(r){h({title:"Error",description:r.message,variant:"destructive"})}},ye=async s=>{if(!t){h({title:"Login Required",description:"You must be logged in to add organizers.",variant:"destructive"});return}try{const{data:r}=await a.from("knowledge_organizers").select("id").eq("user_id",t.id).eq("title",s.title).maybeSingle();if(r){h({title:"Already Added",description:"This organizer is already in your collection."});return}const{error:m}=await a.from("knowledge_organizers").insert({user_id:t.id,title:s.title,subject:s.subject,topic:s.topic,content:s.content});if(m)throw m;h({title:"Added to Library",description:`${s.title} has been added to your organizers.`})}catch(r){h({title:"Error",description:r.message,variant:"destructive"})}},B=l.filter(s=>{var N,V,D;const r=s.title.toLowerCase().includes(i.toLowerCase())||((N=s.subject)==null?void 0:N.toLowerCase().includes(i.toLowerCase()))||((V=s.exam_board)==null?void 0:V.toLowerCase().includes(i.toLowerCase())),m=g==="all"||((D=s.year)==null?void 0:D.toString())===g,b=c==="all"||s.subject===c;return r&&m&&b}),O=u.filter(s=>{var b,N;const r=s.title.toLowerCase().includes(i.toLowerCase())||((b=s.subject)==null?void 0:b.toLowerCase().includes(i.toLowerCase()))||((N=s.topic)==null?void 0:N.toLowerCase().includes(i.toLowerCase())),m=c==="all"||s.subject===c;return r&&m});return e.jsx(Ee,{children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-8 animate-fade-in pb-20",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Te,{className:"h-8 w-8 text-primary"}),e.jsx("h1",{className:"text-4xl font-extrabold tracking-tight",children:"Global Library"})]}),e.jsx("p",{className:"text-muted-foreground text-lg",children:"Discover verified past papers and pre-made knowledge organizers."})]}),e.jsx("div",{className:"flex flex-col items-end gap-2",children:e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 rounded-full bg-emerald-500/10 border border-emerald-500/20 text-emerald-600",children:[e.jsx(q,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-bold uppercase tracking-wider",children:"Trusted Sources Only"})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-muted-foreground group-focus-within:text-primary transition-colors",children:e.jsx(_e,{className:"h-5 w-5"})}),e.jsx(U,{placeholder:"Search library...",value:i,onChange:s=>f(s.target.value),className:"pl-10 h-12 bg-background border-primary/10 rounded-xl shadow-sm"})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[j==="papers"&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs(H,{value:g,onValueChange:v,children:[e.jsx(W,{className:"w-[130px] h-10",children:e.jsx(J,{placeholder:"Year"})}),e.jsxs(X,{children:[e.jsx(P,{value:"all",children:"All Years"}),he.map(s=>e.jsx(P,{value:s.toString(),children:s},s))]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Pe,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs(H,{value:c,onValueChange:x,children:[e.jsx(W,{className:"w-[160px] h-10",children:e.jsx(J,{placeholder:"Subject"})}),e.jsxs(X,{children:[e.jsx(P,{value:"all",children:"All Subjects"}),be.map(s=>e.jsx(P,{value:s,children:s},s))]})]})]})]})]}),e.jsxs(qe,{value:j,onValueChange:pe,className:"w-full",children:[e.jsxs(xe,{className:"grid w-full grid-cols-3 mb-8 h-12 p-1 bg-muted/50 backdrop-blur-sm rounded-xl",children:[e.jsxs(k,{value:"papers",className:"rounded-lg font-bold text-base flex gap-2",children:[e.jsx(ke,{className:"h-4 w-4"})," Past Papers"]}),e.jsxs(k,{value:"organizers",className:"rounded-lg font-bold text-base flex gap-2",children:[e.jsx(Y,{className:"h-4 w-4"})," Knowledge Organizers"]}),e.jsxs(k,{value:"search",className:"rounded-lg font-bold text-base flex gap-2",children:[e.jsx(Le,{className:"h-4 w-4"})," Resource Center"]})]}),e.jsx(L,{value:"papers",className:"space-y-8",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"md:col-span-2 space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[B.map(s=>e.jsxs(S,{className:"hover:shadow-lg transition-all border-primary/5 group",children:[e.jsxs(C,{className:"p-4 pb-2",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(o,{variant:"outline",className:"bg-primary/5 text-primary border-primary/10",children:s.exam_board}),e.jsx(w,{size:"icon",variant:"ghost",onClick:()=>ve(s),className:"h-8 w-8 text-primary hover:bg-primary/10",children:e.jsx(K,{className:"h-5 w-5"})})]}),e.jsx(T,{className:"text-base mt-2 line-clamp-2",children:s.title})]}),e.jsxs(_,{className:"p-4 pt-0 flex justify-between items-center",children:[e.jsxs("span",{className:"text-xs font-medium text-muted-foreground",children:[s.subject," • ",s.year]}),e.jsx("div",{className:"text-[10px] font-bold text-emerald-500 bg-emerald-500/10 px-2 py-0.5 rounded-full uppercase",children:"Verified"})]})]},s.id)),B.length===0&&e.jsx("div",{className:"col-span-full py-20 text-center text-muted-foreground",children:"No papers found matching your criteria."})]})}),e.jsx("div",{className:"md:col-span-1",children:e.jsx("div",{className:"sticky top-24",children:e.jsxs(S,{className:"border-primary/20 shadow-xl overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-primary"}),e.jsxs(C,{className:"bg-primary/5",children:[e.jsxs(T,{className:"flex items-center gap-2 text-primary",children:[e.jsx(Ie,{className:"h-5 w-5"})," Smart Link Importer"]}),e.jsx(A,{children:"Found a paper link on PMT or PapaCambridge? Paste it below and we''ll auto-format it for you."})]}),e.jsxs(_,{className:"p-6 space-y-4",children:[e.jsx(U,{placeholder:"https://...",value:y,onChange:s=>M(s.target.value),className:"border-primary/10 focus:border-primary focus:ring-primary h-12"}),e.jsx(w,{className:"w-full h-12 font-bold gap-2 text-lg shadow-primary/20",onClick:je,disabled:G||!y,children:G?"Working Magic...":"Add with Smart Parser"}),e.jsx("div",{className:"pt-4 border-t border-primary/5",children:e.jsxs("p",{className:"text-[10px] text-muted-foreground font-medium flex items-center gap-1",children:[e.jsx(Re,{className:"h-3 w-3"})," Note: This uses URLs only. Scientia.ai does not host or redistribute any PDF files."]})})]})]})})})]})}),e.jsx(L,{value:"organizers",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:[O.map(s=>{var r,m,b;return e.jsxs(S,{className:"hover:shadow-xl transition-all border-primary/5 group relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-3",children:e.jsx(w,{size:"icon",variant:"secondary",onClick:()=>ye(s),className:"h-10 w-10 shadow-lg",children:e.jsx(K,{className:"h-6 w-6"})})}),e.jsxs(C,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(o,{className:"bg-primary/10 text-primary border-none",children:((r=s.content)==null?void 0:r.exam_board)||"General"}),e.jsx(o,{variant:"outline",className:"text-muted-foreground",children:s.subject})]}),e.jsx(T,{className:"text-xl group-hover:text-primary transition-colors",children:s.title}),e.jsx(A,{className:"line-clamp-2 mt-2",children:s.topic})]}),e.jsx(_,{children:e.jsxs("div",{className:"text-xs text-muted-foreground flex items-center gap-2",children:[e.jsx(Y,{className:"h-3 w-3"}),((b=(m=s.content)==null?void 0:m.sections)==null?void 0:b.length)||0," Professional Sections"]})})]},s.id)}),O.length===0&&e.jsx("div",{className:"col-span-full py-20 text-center text-muted-foreground",children:"No organizers found matching your criteria."})]})}),e.jsxs(L,{value:"search",className:"space-y-6",children:[e.jsx("div",{className:"bg-amber-500/10 border border-amber-500/20 p-6 rounded-2xl",children:e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 rounded-lg bg-amber-500/20",children:e.jsx(q,{className:"h-6 w-6 text-amber-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg",children:"100% Legal & Safe"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["These links open official third-party resources in a ",e.jsx("strong",{children:"new tab"}),". Scientia.ai does not host, frame, or redistribute any copyrighted materials."]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(S,{className:"border-2 border-blue-500/20 hover:border-blue-500/40 transition-all hover:shadow-xl group",children:[e.jsxs(C,{className:"pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(o,{className:"bg-blue-500/10 text-blue-600 border-blue-500/20",children:"Recommended"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"STEM & Core Subjects"})]}),e.jsx(T,{className:"text-2xl mt-4",children:"Physics & Maths Tutor"}),e.jsx(A,{className:"text-base",children:"The UK''s most trusted student resource for Science, Maths, and English past papers."})]}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(o,{variant:"outline",children:"Biology"}),e.jsx(o,{variant:"outline",children:"Chemistry"}),e.jsx(o,{variant:"outline",children:"Physics"}),e.jsx(o,{variant:"outline",children:"Maths"}),e.jsx(o,{variant:"outline",children:"English"}),e.jsx(o,{variant:"outline",children:"History"}),e.jsx(o,{variant:"outline",children:"Geography"})]}),e.jsx(w,{className:"w-full h-14 text-lg font-bold gap-3 bg-blue-600 hover:bg-blue-700",asChild:!0,children:e.jsxs("a",{href:"https://www.physicsandmathstutor.com/past-papers/",target:"_blank",rel:"noopener noreferrer",children:["Open PMT Past Papers ",e.jsx(Q,{className:"h-5 w-5"})]})}),e.jsx("p",{className:"text-xs text-center text-muted-foreground",children:"Opens in a new tab • physicsandmathstutor.com"})]})]}),e.jsxs(S,{className:"border-2 border-purple-500/20 hover:border-purple-500/40 transition-all hover:shadow-xl group",children:[e.jsxs(C,{className:"pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(o,{className:"bg-purple-500/10 text-purple-600 border-purple-500/20",children:"Full Coverage"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"All AQA Subjects"})]}),e.jsx(T,{className:"text-2xl mt-4",children:"PapaCambridge"}),e.jsx(A,{className:"text-base",children:"Comprehensive archive covering every AQA subject including Business & Languages."})]}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(o,{variant:"outline",children:"Business"}),e.jsx(o,{variant:"outline",children:"French"}),e.jsx(o,{variant:"outline",children:"Spanish"}),e.jsx(o,{variant:"outline",children:"German"}),e.jsx(o,{variant:"outline",children:"PE"}),e.jsx(o,{variant:"outline",children:"+ All Others"})]}),e.jsx(w,{className:"w-full h-14 text-lg font-bold gap-3 bg-purple-600 hover:bg-purple-700",asChild:!0,children:e.jsxs("a",{href:"https://pastpapers.papacambridge.com/papers/aqa/gcse",target:"_blank",rel:"noopener noreferrer",children:["Open PapaCambridge ",e.jsx(Q,{className:"h-5 w-5"})]})}),e.jsx("p",{className:"text-xs text-center text-muted-foreground",children:"Opens in a new tab • papacambridge.com"})]})]})]})]})]})]})})}export{ns as default};

import{a4 as g}from"./index-7wMNJNZJ.js";const i=window.location.origin;async function f(r){try{let e=r;if(!e)return null;const{data:{session:a}}=await e.auth.getSession();return a?.access_token||null}catch{return null}}async function c(r,e={},a){try{const t=await f(a);if(!t)return{error:"Not authenticated. Please sign in to use AI features."};const s=`${i}${r}`,o=await fetch(s,{...e,headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`,...e.headers}});let n;const u=o.headers.get("content-type");if(u&&u.includes("application/json"))n=await o.json();else return{error:`Server returned non-JSON response: ${(await o.text()).substring(0,200)}`};return o.ok?{data:n}:{error:typeof n.error=="object"?n.error.message||JSON.stringify(n.error):n.error||`Request failed with status ${o.status}`,message:n.message}}catch(t){return t instanceof TypeError&&t.message.includes("fetch")?{error:`Failed to connect to API server. Please check:
- Is the server running? (Expected: ${i})
- Is VITE_API_URL set correctly in your .env file?
- Check your network connection and CORS settings.`}:{error:t instanceof Error?t.message:"Network error occurred"}}}async function l(r,e){return c("/api/ai/generate-flashcards",{method:"POST",body:JSON.stringify(r)},e)}async function p(r,e){return c("/api/ai/generate-knowledge-organizer",{method:"POST",body:JSON.stringify(r)},e)}const y=async(r,e)=>c("/api/ai/chat",{method:"POST",body:JSON.stringify(r)},e);async function w(r,e){try{const{data:{session:a}}=await r.auth.getSession();if(!a)throw new Error("Not authenticated");let t=`${i}/api/ai/usage`;const s=await fetch(t,{method:"GET",headers:{Authorization:`Bearer ${a.access_token}`,"Content-Type":"application/json"}});if(!s.ok){const n=await s.json();throw new Error(n.error||"Failed to fetch usage stats")}return{data:await s.json()}}catch(a){return{error:a.message}}}export{l as a,p as b,y as c,w as g};

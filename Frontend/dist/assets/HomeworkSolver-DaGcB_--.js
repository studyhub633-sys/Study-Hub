import{c as H,u as B,n as G,r as t,j as e,L as D,B as d,X as M}from"./index-7wMNJNZJ.js";import{A as u,h as Q}from"./AppLayout-Cb4f3Rcb.js";import{L as Y}from"./LimitReachedDialog-DRrwZmYv.js";import{C as p,a as h,b as x,c as f,d as g}from"./card-BDQx_yt9.js";import{T as W}from"./textarea-DYv1Zddw.js";import{c as $}from"./ai-client-SJ9RPCaW.js";import{c as j}from"./sheet-D4eoD1m7.js";import{S as C}from"./sparkles-BGeiEV-p.js";import"./AnimatedLogoIcon-DY32PEux.js";import"./sun-CnDoiXzg.js";const J=H("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);function ae(){const{supabase:m,user:v}=B(),{toast:i}=G(),[l,P]=t.useState(""),[y,b]=t.useState(!1),[n,N]=t.useState(null),[a,w]=t.useState(null),[A,k]=t.useState(null),c=t.useRef(null),[R,F]=t.useState(!1),[L,S]=t.useState(!0);t.useEffect(()=>{(async()=>{if(!v||!m){S(!1);return}try{const s=await Q(m);F(s)}catch{}finally{S(!1)}})()},[v]);const U=r=>{const s=r.target.files?.[0];if(!s)return;if(!s.type.startsWith("image/")){i({title:"Invalid file",description:"Please upload an image file (PNG, JPG, GIF, etc.)",variant:"destructive"});return}if(s.size>5*1024*1024){i({title:"File too large",description:"Please upload an image smaller than 5MB",variant:"destructive"});return}const o=new FileReader;o.onload=z=>{w(z.target?.result),k(s.name),i({title:"Image uploaded",description:"You can add a specific question or just click Solve to analyze the image."})},o.readAsDataURL(s)},q=()=>{w(null),k(null),c.current&&(c.current.value="")},E=async()=>{if(!l.trim()&&!a){i({title:"Error",description:"Please enter a question or upload an image to solve.",variant:"destructive"});return}b(!0),N(null);try{let r="Please solve this homework question step-by-step. Provide a clear explanation of each step, show your work, and explain the reasoning behind each step. If applicable, identify the key concepts being tested.";l&&(r+=`

Question: ${l}`);const s=await $({message:r,context:"You are an expert tutor who provides clear, step-by-step solutions to homework problems. Always show your work and explain your reasoning.",image:a||void 0},m);if(s.error){if(s.error.includes("limit")||s.error.includes("429")){I(!0);return}throw new Error(s.error)}const o=s.data?.reply;if(o)N(o),i({title:"Success",description:"Solution generated successfully!"});else throw new Error("No response from AI")}catch(r){i({title:"Error",description:r.message||"Failed to solve question. Please try again.",variant:"destructive"})}finally{b(!1)}},[T,I]=t.useState(!1);return L?e.jsx(u,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsx(D,{className:"h-8 w-8 animate-spin text-primary"})})}):R?e.jsxs(u,{children:[e.jsx(Y,{open:T,onOpenChange:I}),e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6 animate-fade-in pb-12",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-3 rounded-xl bg-purple-500/10 text-purple-500",children:e.jsx(j,{className:"w-8 h-8"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"AI Homework Solver"}),e.jsx("p",{className:"text-muted-foreground",children:"Get instant, step-by-step solutions for any subject."})]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(p,{children:[e.jsxs(h,{children:[e.jsx(x,{children:"Your Question"}),e.jsx(f,{children:"Type your question or upload an image"})]}),e.jsxs(g,{className:"space-y-4",children:[a&&e.jsxs("div",{className:"relative rounded-lg border-2 border-dashed border-purple-500/30 p-2 bg-purple-500/5",children:[e.jsx("img",{src:a,alt:"Uploaded homework",className:"max-h-[150px] w-full object-contain rounded"}),e.jsx(d,{variant:"destructive",size:"icon",className:"absolute top-1 right-1 h-6 w-6 rounded-full",onClick:q,children:e.jsx(M,{className:"h-3 w-3"})}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1 text-center truncate",children:A})]}),e.jsx(W,{placeholder:a?"Add any specific instructions or context for the image...":"Paste your homework question here...",className:"min-h-[150px] resize-none",value:l,onChange:r=>P(r.target.value)}),e.jsx("input",{type:"file",ref:c,accept:"image/*",onChange:U,className:"hidden"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs(d,{variant:"outline",className:"flex-1",onClick:()=>c.current?.click(),children:[e.jsx(J,{className:"w-4 h-4 mr-2"}),a?"Change Image":"Upload Image"]}),e.jsx(d,{className:"flex-1 bg-purple-600 hover:bg-purple-700",onClick:E,disabled:!l&&!a||y,children:y?e.jsx(e.Fragment,{children:"Processing..."}):e.jsxs(e.Fragment,{children:[e.jsx(C,{className:"w-4 h-4 mr-2"}),"Solve with AI"]})})]})]})]}),e.jsxs(p,{className:`border-purple-500/20 ${n?"bg-purple-500/5":""}`,children:[e.jsxs(h,{children:[e.jsx(x,{children:"AI Solution"}),e.jsx(f,{children:n?"Analysis complete":"Solution will appear here"})]}),e.jsx(g,{children:n?e.jsxs("div",{className:"prose dark:prose-invert max-h-[400px] overflow-y-auto",children:[e.jsx("p",{className:"whitespace-pre-line",children:n}),e.jsxs("div",{className:"mt-6 p-4 bg-purple-500/10 rounded-lg border border-purple-500/20",children:[e.jsxs("h4",{className:"font-semibold text-purple-400 mb-2 flex items-center",children:[e.jsx(C,{className:"w-4 h-4 mr-2"}),"Key Concept"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"This problem relates to [Topic Name]. Mastering this concept will help you solve similar problems in the future."})]})]}):e.jsxs("div",{className:"h-[200px] flex flex-col items-center justify-center text-muted-foreground opacity-50",children:[e.jsx(j,{className:"w-12 h-12 mb-4"}),e.jsx("p",{children:"Ready to solve"})]})})]})]})]})]}):e.jsx(u,{children:e.jsx("div",{className:"max-w-4xl mx-auto py-12",children:e.jsxs(p,{className:"border-amber-500/20 bg-amber-500/5",children:[e.jsxs(h,{children:[e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(j,{className:"w-6 h-6 text-amber-500"}),"Premium Feature"]}),e.jsx(f,{children:"AI Homework Solver is a premium feature"})]}),e.jsxs(g,{children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"Upgrade to premium to get instant, step-by-step solutions for any subject."}),e.jsx(d,{onClick:()=>window.location.href="/premium-dashboard",className:"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700",children:"View Premium Plans"})]})]})})})}export{ae as default};

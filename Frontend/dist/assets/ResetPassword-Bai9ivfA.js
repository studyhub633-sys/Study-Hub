import{j as e,a8 as E,aq as A,E as q,L as F}from"./ui-vendor-C99L-hD9.js";import{A as Y,B as n}from"./button-CQxizq7v.js";import{A as x,a as f}from"./alert-DdFVzRhO.js";import{C as D,a as I,b as R,c as T,d as z}from"./card-B84tWNIN.js";import{I as w}from"./input-BPzbhsiA.js";import{L as j}from"./label-Bre8CuGw.js";import{u as B}from"./index-bKh4zXg2.js";import{r as s,u as U,L as g}from"./react-vendor-CW_qxVlV.js";import"./supabase-vendor-BFJX04bJ.js";import"./query-vendor-CVP6rs-5.js";function Z(){const[t,N]=s.useState(""),[c,b]=s.useState(""),[r,v]=s.useState(!1),[m,o]=s.useState(""),[i,u]=s.useState(!1),[d,y]=s.useState(!1),{updatePassword:C,session:l,loading:h}=B(),P=U(),[p,S]=s.useState(!0);s.useEffect(()=>{h||S(!1)},[h]);const k=async a=>{if(a.preventDefault(),o(""),t!==c){o("Passwords do not match");return}if(t.length<6){o("Password must be at least 6 characters long");return}u(!0);try{await C(t),y(!0),setTimeout(()=>{P("/login")},3e3)}catch(L){o(L.message||"Failed to update password. Please try again.")}finally{u(!1)}};return e.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-b from-background to-muted/20 p-4",children:e.jsxs(D,{className:"w-full max-w-md",children:[e.jsxs(I,{className:"space-y-1 text-center",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx(Y,{})}),e.jsx(R,{className:"text-2xl font-bold",children:"Set New Password"}),e.jsx(T,{children:d?"Your password has been successfully reset":!l&&!p?"Your reset link may have expired or is invalid.":"Enter your new password below"})]}),e.jsxs(z,{children:[!l&&!p&&!d&&e.jsxs("div",{className:"mb-4",children:[e.jsx(x,{variant:"destructive",children:e.jsx(f,{children:"Authentication session is missing. This happens if the link is expired or if you've opened it in a different browser than where you started."})}),e.jsx(g,{to:"/forgot-password",children:e.jsx(n,{variant:"outline",className:"w-full mt-2",children:"Request a new link"})})]}),d?e.jsxs("div",{className:"text-center py-4 space-y-4",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx(E,{className:"h-12 w-12 text-green-500 animate-in zoom-in duration-300"})}),e.jsx("p",{className:"text-muted-foreground",children:"Your password has been updated. You will be redirected to the login page shortly."}),e.jsx(g,{to:"/login",className:"block mt-4",children:e.jsx(n,{className:"w-full",children:"Login Now"})})]}):e.jsxs("form",{onSubmit:k,className:"space-y-4",children:[m&&e.jsx(x,{variant:"destructive",children:e.jsx(f,{children:m})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"password",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(w,{id:"password",type:r?"text":"password",placeholder:"Enter new password",value:t,onChange:a=>N(a.target.value),required:!0,disabled:i,className:"pr-10"}),e.jsx(n,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>v(!r),children:r?e.jsx(A,{className:"h-4 w-4 text-muted-foreground"}):e.jsx(q,{className:"h-4 w-4 text-muted-foreground"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"confirmPassword",children:"Confirm New Password"}),e.jsx(w,{id:"confirmPassword",type:r?"text":"password",placeholder:"Confirm new password",value:c,onChange:a=>b(a.target.value),required:!0,disabled:i})]}),e.jsx(n,{type:"submit",className:"w-full",disabled:i||!l,children:i?e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"mr-2 h-4 w-4 animate-spin"}),"Updating password..."]}):"Update Password"})]})]})]})})}export{Z as default};

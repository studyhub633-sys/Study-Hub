import{r as a,u as A,b as D,m as F,j as s,t as f,B as d,L as q}from"./index-7wMNJNZJ.js";import{A as I}from"./AnimatedLogoIcon-DY32PEux.js";import{A as w,a as j}from"./alert-Cruc9TpM.js";import{C as R,a as T,b as z,c as B,d as M}from"./card-BDQx_yt9.js";import{I as g}from"./input-CURGwIC-.js";import{L as N}from"./label-4_8C0ZIE.js";import{C as H}from"./circle-check-C8Ohiiaq.js";import{E as O}from"./eye-off-Dc-yaQ5U.js";import{E as U}from"./eye-COppsmZo.js";function _(){const[r,v]=a.useState(""),[u,b]=a.useState(""),[o,y]=a.useState(!1),[m,i]=a.useState(""),[n,h]=a.useState(!1),[l,P]=a.useState(!1),{updatePassword:C,session:c,loading:x}=A(),S=D(),{t:e}=F(),[p,L]=a.useState(!0);a.useEffect(()=>{x||L(!1)},[x]);const k=async t=>{if(t.preventDefault(),i(""),r!==u){i(e("auth.passwordsDoNotMatch"));return}if(r.length<6){i(e("auth.passwordLength"));return}h(!0);try{await C(r),P(!0),setTimeout(()=>{S("/login")},3e3)}catch(E){i(E.message||"Failed to update password. Please try again.")}finally{h(!1)}};return s.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-b from-background to-muted/20 p-4",children:s.jsxs(R,{className:"w-full max-w-md",children:[s.jsxs(T,{className:"space-y-1 text-center",children:[s.jsx("div",{className:"flex justify-center mb-4",children:s.jsx(I,{})}),s.jsx(z,{className:"text-2xl font-bold",children:e("auth.setNewPassword")}),s.jsx(B,{children:e(l?"auth.successReset":!c&&!p?"auth.linkExpired":"auth.enterNewPassword")})]}),s.jsxs(M,{children:[!c&&!p&&!l&&s.jsxs("div",{className:"mb-4",children:[s.jsx(w,{variant:"destructive",children:s.jsx(j,{children:e("auth.sessionMissing")})}),s.jsx(f,{to:"/forgot-password",children:s.jsx(d,{variant:"outline",className:"w-full mt-2",children:e("auth.requestNewLink")})})]}),l?s.jsxs("div",{className:"text-center py-4 space-y-4",children:[s.jsx("div",{className:"flex justify-center",children:s.jsx(H,{className:"h-12 w-12 text-green-500 animate-in zoom-in duration-300"})}),s.jsx("p",{className:"text-muted-foreground",children:e("auth.passwordUpdated")}),s.jsx(f,{to:"/login",className:"block mt-4",children:s.jsx(d,{className:"w-full",children:e("auth.loginNow")})})]}):s.jsxs("form",{onSubmit:k,className:"space-y-4",children:[m&&s.jsx(w,{variant:"destructive",children:s.jsx(j,{children:m})}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(N,{htmlFor:"password",children:e("auth.newPassword")}),s.jsxs("div",{className:"relative",children:[s.jsx(g,{id:"password",type:o?"text":"password",placeholder:e("auth.enterNewPasswordPlaceholder"),value:r,onChange:t=>v(t.target.value),required:!0,disabled:n,className:"pr-10"}),s.jsx(d,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>y(!o),children:o?s.jsx(O,{className:"h-4 w-4 text-muted-foreground"}):s.jsx(U,{className:"h-4 w-4 text-muted-foreground"})})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(N,{htmlFor:"confirmPassword",children:e("common.confirmPassword")}),s.jsx(g,{id:"confirmPassword",type:o?"text":"password",placeholder:e("auth.confirmNewPasswordPlaceholder"),value:u,onChange:t=>b(t.target.value),required:!0,disabled:n})]}),s.jsx(d,{type:"submit",className:"w-full",disabled:n||!c,children:n?s.jsxs(s.Fragment,{children:[s.jsx(q,{className:"mr-2 h-4 w-4 animate-spin"}),e("auth.updatingDotted")]}):e("auth.updatePassword")})]})]})]})})}export{_ as default};
